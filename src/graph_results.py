
import os
import logging
import math
import pandas as pd
import torch
import torch.nn.functional as F
import numpy as np
import matplotlib.pyplot as plt


q_utility_40 = [16.650000000000002, 22.770000000000003, 27.24, 19.669999999999998, 30.819999999999997, 23.95, 24.8322418511047, 28.265481695300494, 32.189217933689804, 37.6780917076146, 40.5547173574286, 45.3093888493494, 47.09911216940554, 49.15204074596197, 53.3045435216022, 52.263562457878734, 47.94964245659523, 56.49949278404742, 56.558291459831906, 60.1301187880536, 61.37177500425967, 59.205811952198374, 59.865764539536734, 62.98647894610062, 62.50481880805329, 63.633366450724466, 62.838568318736336, 65.00583588863988, 62.80249632606913, 66.9769435001419, 66.0512896911398, 66.75660289183135, 64.3839295877228, 66.74338645878525, 67.52237777532852, 66.89606618949405, 67.4411642073592, 66.68352446415331, 68.51010364120833, 67.52939324733799, 64.5761223315162, 57.03225639251828, 68.46691433284639, 68.53157104287266, 70.5755625104824, 70.0849411436403, 70.37701304448619, 70.08782463290686, 69.69196398194106, 69.95402895985144, 71.41252205533144, 69.73016759160583, 70.10471288433914, 70.18359670546802, 70.30588621509415, 70.04884634446854, 72.58859394364325, 72.57256769966287, 70.51451633301552, 71.66710541084232]
shapley_utility_40 = [17.19, 21.52, 28.439999999999998, 30.7883, 35.06653333333333, 38.318799999999996, 43.71906666666667, 46.07506666666667, 50.146100000000004, 49.76384, 55.2888, 56.513900000000014, 58.084266666666664, 56.66752000000001, 60.113866666666674, 63.2912, 62.52613333333335, 53.610400000000006, 64.74624, 65.30056000000002, 68.57070000000002, 67.00376, 67.56648000000001, 69.26979999999999, 69.74226666666667, 68.56696000000001, 66.2964, 72.161, 71.92410000000001, 70.35346666666668, 69.36984000000001, 71.7596, 70.0412, 71.2692, 72.8228, 72.21328, 75.239, 75.69420000000001, 72.71544, 75.3367, 74.18666666666667, 75.3734, 72.5312, 75.8095, 75.14890000000001, 74.95946666666667, 75.42693333333334, 76.336, 75.35986666666668, 74.17784, 75.39333333333335, 75.77351999999999, 75.20960000000001, 76.21893333333334, 75.2993, 76.2836, 75.51533333333334, 75.71728, 76.96013333333335, 78.04230000000001]
greedy_40 = [35.44, 43.15, 21.700000000000003, 50.260000000000005, 32.849999999999994, 55.379999999999995, 37.959999999999994, 59.93000000000001, 41.91999999999999, 62.29, 45.36999999999999, 67.95, 48.389999999999986, 70.34, 50.91, 73.28, 52.05, 73.18, 55.09, 76.55999999999999, 54.64999999999999, 74.45, 56.879999999999995, 79.02, 57.25, 79.91, 58.53, 76.39, 60.099999999999994, 73.25, 59.459999999999994, 79.63, 60.239999999999995, 82.47, 59.77999999999999, 83.48, 60.30999999999999, 80.01, 62.64999999999999, 85.42999999999999, 63.44, 84.91, 62.879999999999995, 86.13, 64.21999999999998, 86.26, 62.00999999999999, 86.61999999999999, 64.28999999999999, 86.95, 64.39999999999999, 86.49, 65.49, 86.56, 64.38, 87.13, 65.78999999999999, 87.92999999999999]
uniform_40= [24.310000000000002, 30.81, 11.130000000000003, 3.1400000000000006, 5.251711896992489, 7.499369234660435, 9.635881998452447, 9.263094969491185, 14.096496626639158, 12.688619654864212, 14.854082095153338, 15.515216220253755, 15.545586459752123, 15.936529835293932, 14.56033557247838, 16.28290951343122, 14.75275560560609, 15.65136926043661, 14.77320915537075, 13.841470585425412, 13.924343380573347, 11.835920436223432, 12.081492727201791, 11.392235810178306, 8.572583365188393, 6.97817498147765, 8.903530841869326, 7.347066417064113, 6.464724760410547, 5.330902907757576, 5.049367129370367, 3.7387386931348345, 3.043699543296242, 1.4583241621313903, 1.3392665656728582, 0.4057611220483608, -0.8212910000777356, -1.7967028229632689, -2.853231936511037, -3.8665457838410475, -4.148672001071887, -5.118299786838918, -6.023217005309121, -7.008234349996798, -8.269196535600841, -8.910099809770443, -10.080615556868793, -10.380279329070888, -11.66913893839434, -12.067220900903905, -13.14700911761797, -13.817507158974067, -14.98858320593402, -15.710060909581543, -16.664271029374163, -17.25876114693341, -18.62699911057591, -19.025492342159666]

def graph_combine(id):
    

    x_axis = [x for x in range(len(shapley_utility_40))]
    
    fig, ax1 = plt.subplots(dpi = 500)

    ax1.plot(x_axis,q_utility_40, label='ROBOFL', color='red', linestyle='solid')
    ax1.plot(x_axis,shapley_utility_40, label='SV', color='blue', linestyle='dashdot')    
    # ax1.plot(x_axis,fifl_40, label='FIFL', color='orange', linestyle='dashed')
    # ax1.plot(x_axis,greedy_40, label='Greedy', color='black', linestyle='dashed')
    # ax1.plot(x_axis,uniform_40, label='Uniform', color='green', linestyle='dotted')

    ax1.set_xlabel("Matching round, R", fontsize=15,  fontweight='bold')
    ax1.set_ylabel('Utility', fontsize=15, fontweight='bold')
    
    ax1.legend(fontsize= 12, loc='best', bbox_to_anchor=(0.5, 0., 0.5, 0.6))
    # plt.show()
    plt.grid()
    file_name=f"comparison_{id}.pdf"
    plt.savefig(file_name, dpi = 500)

# graph_combine(1)

fifl_10 = [80.97, 86.09, 81.9103511072317, 85.1885231148771, 86.34420088769967, 86.30320673637986, 80.97925936601351, 87.04214277075593, 88.64033115027334, 89.24640786164437, 88.39907205560806, 88.86035020377881, 86.83463098583834, 89.33739978816448, 89.22403399869876, 90.18667665708303, 90.48502915306828, 89.99150661088673, 88.1738961077342, 87.14997706340014, 89.59302503421145, 89.6672448418501, 86.5201256620042, 85.75705779104092, 89.66099637196216, 90.09115949649656, 89.26258621328365, 89.84404742739754, 89.03585962672787, 90.39847768957156, 89.33967667114914, 88.76328325788133, 91.03155575751133, 89.55321133407523, 90.4347521848065, 86.3157786529276, 90.31413527197613, 88.58823303463066, 87.39950918417284, 89.4931108846746, 87.77939807017563, 89.22171108757495, 89.30892398052153, 88.32277686863635, 90.52834586554388, 88.8096135727566, 89.90105374253535, 88.92670240174466, 86.85868892781706, 88.7524025672852, 89.93801325688514, 88.04809913730071, 89.41973653137381, 88.04954798782748, 89.97898054844637, 90.07124911403253, 88.87393368396168, 89.84082756176385]
fifl_100 = [10.39, 12.690000000000001, -36.577003137018885, -26.92834900616178, -20.71923951051688, -14.237584514152388, -12.263206741080065, -6.19880376546492, 2.376591489866275, 4.065256894918001, 9.364673667505212, 10.784964639671053, 8.796285592321663, 14.959380862454413, 16.299407779462193, 20.220877926969845, 20.73461208717949, 26.882376809956224, 27.912906985077488, 28.321621881326305, 22.5123003338129, 38.03138032473247, 37.369174344700355, 33.400576377020215, 43.203299745244486, 45.91477383760362, 43.642252822192766, 46.20457086838825, 41.83788927406469, 51.50332292309433, 46.86921326838252, 50.596151196868284, 54.7235760898907, 54.34081994896251, 57.83871371511068, 56.07786532640024, 59.252766511029165, 54.363287372814895, 59.970970084205355, 58.372476846115596, 59.01139220467373, 63.07782831229057, 63.554454764363335, 60.9981847988505, 63.51152655247296, 55.049941346240786, 65.41467700465901, 65.23670320175921, 67.46240494559815, 66.58733803174486, 67.91219901564102, 67.99795360398426, 52.411758211487694, 69.58862137672371, 69.53082470885536, 70.31517947369937, 69.5892248548045, 70.88144948692965]
fifl_200 = [12.01, 14.2, -5.457735981542575, 0.3316789730176737, 2.299247388349688, 4.178563640672952, 6.581713294784587, 7.62725724728487, 9.121347622312157, 10.639259069558868, 11.324325426152448, 13.505446245739174, 14.284510297208138, 15.45413992564978, 16.15397528417055, 17.961183739397107, 16.573489677817925, 18.550016757683423, 19.386814157998902, 20.63686321566871, 21.469224649218724, 22.174830661313987, 23.63859052747371, 23.678442936832916, 24.977314863811408, 23.937043877186618, 23.612506354252943, 24.673690903113418, 27.30393578500305, 29.211402339009346, 26.283889523162774, 28.30969993053407, 28.945431169824374, 32.00634721992474, 30.44324165210991, 32.136269082689466, 29.974964817967464, 33.538979983102756, 32.77804591387811, 33.3199123476605, 34.99870805774419, 34.52260999126631, 37.591868274332704, 36.29757482607343, 37.292218961760085, 38.91350846412527, 37.679972604493415, 40.9558387022269, 40.46633589379705, 41.467073275747126, 43.08977860495912, 42.631738772753636, 44.37454377051232, 43.15510732057745, 45.56407718557264, 46.584954765130625, 47.62388292434854, 48.189832529097394]

uni_10 = [76.55, 82.19999999999999, 77.58, 76.57000000000001, 77.59181798106036, 75.82899447128713, 68.48737493765708, 76.65397463498405, 77.4658487436352, 77.14146743201677, 68.27296425205637, 73.59801735761025, 58.2633288654746, 75.55474173625723, 66.92093410335202, 73.65244285932413, 74.67588799534623, 74.18328906120817, 73.97897377749858, 65.81581483025289, 71.11163754687566, 67.95016713933579, 72.56062811531497, 70.31971162826044, 70.88641446114622, 68.99365029701423, 59.1693332227839, 69.83072175451974, 68.26010806166906, 68.66744366286595, 68.57052787017267, 68.85055195795655, 46.75658323321932, 66.63839269305313, 67.4450347788491, 67.31743385381061, 59.06445178517931, 66.80620598452467, 66.23335819753063, 66.06515565893548, 65.4010986948794, 62.36093333230645, 64.87503475046489, 65.16359653369398, 64.29428015205556, 64.19051559317113, 62.598707482528894, 62.241127180619166, 37.26657694413065, 63.02520101417275, 62.3470560618671, 61.31260047501308, 53.580345263548224, 59.87146502502185, 60.13577082564029, 61.78136743541285, 59.74118742447879, 55.432287413682914]
uni_100 = [21.82, 25.81, -35.489999999999995, -60.76, -62.72624514989735, -69.0370092490138, -72.83863516869991, -77.79207410943135, -82.02763255835865, -85.619475899944, -91.45441563654666, -94.40222289550711, -97.6851276709103, -100.97462624392193, -104.61337854494295, -106.49203519074885, -111.27171616526249, -114.46472206254528, -116.8110245241649, -119.48320223241842, -123.26030472344422, -125.5086031484087, -128.24207920735248, -131.59635230287347, -134.7119860088327, -137.5428777980439, -140.04020198326933, -142.42420857644663, -144.4777371687175, -147.50978674014044, -150.5193148115535, -153.64443552568207, -155.49980594619296, -157.73812825067807, -161.28159714506148, -163.2118284495623, -166.26791321364306, -168.62174968188896, -170.61353025166173, -172.73454753736226, -175.65497867370956, -179.43710991476206, -179.99293083556404, -185.42428798481987, -186.32662256754168, -187.1392049472459, -191.41949742026856, -191.94480804058165, -194.6993412886162, -197.47044175689254, -198.41262280508738, -201.37962391597955, -204.86398950340998, -206.1830309082539, -207.78768067900072, -210.06106647805882, -213.43286453782576, -215.74232641701258]
uni_200 =[29.439999999999998, 34.599999999999994, 13.309999999999999, -121.13, -167.08, -173.0215175782539, -183.88780605187634, -195.14768094477859, -205.6899435130254, -215.69535963835202, -225.34173082495153, -234.60644575907443, -243.57224802413958, -252.22438713888113, -260.50381334853796, -268.64063567834086, -276.4183700104266, -284.1031294903121, -291.6409242004228, -298.45219265526254, -305.97379014613904, -312.98597087224164, -319.73091136521913, -326.4731924360422, -333.01951698289633, -339.4136049455067, -345.76405548932763, -351.93695105718854, -358.036984212095, -364.0230892225358, -369.97148238472056, -375.64716285419604, -381.4606562077262, -387.0595358759104, -392.70538988070547, -397.731873161632, -403.6595949405684, -408.9331904761476, -414.2170544731216, -419.40302804452307, -424.5616004798842, -429.7238020362914, -434.7456117898937, -439.62918651530026, -444.19026618061946, -449.40878385864295, -454.2939892030074, -459.0632933779257, -463.36202547550295, -468.4468408973129, -471.91240776826794, -477.6670119324772, -482.1786396440023, -486.6877615269063, -491.1585488505255, -495.57728080014783, -499.9890481012106, -504.1836620926688]

greedy_10 = [49.13, 81.96, 80.78, 85.31, 80.80999999999999, 86.24000000000001, 85.11, 76.98, 85.53, 89.45, 84.96000000000001, 72.5, 85.88, 74.00999999999999, 88.01, 89.94, 89.09, 74.3, 88.96, 90.91, 89.3, 76.82, 87.92999999999999, 93.05, 85.52, 80.49, 88.97, 81.23, 90.58999999999999, 93.52000000000001, 90.91, 83.3, 90.4, 93.93, 90.82000000000001, 67.35, 90.34, 93.42, 90.99, 94.05, 91.46, 59.5, 88.09, 92.78, 90.34, 78.38000000000001, 91.56, 79.58, 90.5, 60.92999999999999, 88.39, 93.89, 91.97, 93.38, 91.36, 93.08999999999999, 91.56, 93.89]
greedy_100 = [23.26, 26.06, -26.800000000000004, 27.860000000000003, -12.63999999999998, 28.610000000000003, -10.88999999999998, 32.1, -7.589999999999975, 34.12, -6.329999999999977, 35.010000000000005, -4.149999999999977, 35.03, -2.869999999999976, 39.09, -0.9099999999999753, 39.269999999999996, 2.1300000000000168, 43.71, 2.8100000000000236, 43.87, 4.630000000000024, 46.31, 4.22000000000002, 47.64, 5.960000000000022, 49.05, 9.470000000000027, 47.510000000000005, 10.33000000000002, 45.26, 8.83000000000002, 43.22, 13.29000000000002, 40.64, 14.540000000000028, 57.99999999999999, 16.520000000000017, 58.699999999999996, 17.310000000000016, 58.34, 18.35000000000003, 46.949999999999996, 17.230000000000025, 59.830000000000005, 20.140000000000015, 62.49, 21.190000000000026, 63.160000000000004, 21.400000000000027, 53.59, 22.31000000000003, 61.9, 23.53000000000003, 66.7, 24.020000000000024, 66.73]
greedy_200 = [16.38, 16.869999999999997, -81.11, 19.35, -46.21999999999989, 19.79, -45.57999999999989, 21.72, -44.00999999999989, 23.189999999999998, -41.69999999999989, 23.080000000000002, -42.069999999999894, 24.66, -40.889999999999894, 25.230000000000004, -39.249999999999886, 27.139999999999997, -38.11999999999989, 26.889999999999997, -37.07999999999989, 28.910000000000004, -36.21999999999989, 29.73, -35.029999999999895, 31.330000000000002, -33.529999999999895, 32.019999999999996, -33.11999999999989, 32.550000000000004, -31.65999999999989, 34.31, -31.22999999999989, 34.870000000000005, -30.359999999999893, 34.63, -29.489999999999895, 36.59, -29.779999999999887, 37.56, -27.58999999999989, 38.66, -26.969999999999892, 39.11, -26.73999999999989, 39.92, -26.169999999999895, 40.949999999999996, -25.219999999999892, 41.05, -25.099999999999895, 42.41, -23.90999999999989, 42.75, -22.709999999999894, 43.28, -21.80999999999989, 42.68]

sv_10 =[81.25, 66.02, 78.04, 48.902, 75.634, 61.098, 70.562, 67.29, 54.8, 82.428, 68.59, 83.12400000000001, 83.24999999999999, 83.33999999999999, 83.892, 53.343999999999994, 49.18000000000001, 83.766, 83.41000000000001, 83.148, 82.71600000000001, 83.202, 83.112, 83.21600000000001, 84.33800000000001, 83.46199999999999, 64.982, 83.48400000000001, 83.726, 83.54200000000002, 83.884, 84.148, 83.856, 83.532, 84.186, 83.908, 84.13600000000001, 83.74600000000001, 84.126, 84.14, 84.406, 64.94800000000001, 83.904, 84.37, 83.874, 84.148, 83.708, 84.018, 84.042, 83.948, 84.372, 84.26200000000001, 84.578, 84.508, 84.342, 84.62400000000001, 84.47800000000001, 84.476]
sv_100 = [37.39, 46.51, 53.190000000000005, 3.631495377434703, 1.0175612602100443, 2.65211201866979, -0.5894282380396589, 3.01374562427074, 3.311178529754983, 1.6954959159859868, 2.0854375729288535, 3.899113185530908, 3.9252392065344424, 2.0723337222870555, 2.747211201866989, 2.53823803967326, 1.8680396732788722, 2.479253208868144, 1.9066394399066553, 2.2303150525087574, 3.32029171528589, 3.515192532088676, 2.887642940490082, 1.9849124854142275, 1.8411085180863438, 1.360921820303389, 4.4350991831972095, 1.454632438739793, 1.7844924154025534, 2.374574095682604, 1.5857059509918372, 1.4156476079346447, 3.042100350058348, 1.174294049008168, 1.8492648774795697, 1.6692765460910124, 2.335554259043164, 1.3453325554259123, -6.082193698949808, 3.099276546091019, 0.6429288214702638, 1.7740373395565996, 2.0927304550758663, 1.7703383897316058, -0.31847141190196737, 0.9026954492415342, 0.4049941656942906, 1.9464994165694236, 1.7563710618436374, 1.9125904317386073, 1.6812835472578627, 2.062625437572919, 1.801271878646432, 1.4825670945157867, 1.0713185530921834, 2.7877596266044407, 1.4262193698949943, 2.2350175029171453]
sv_200 = [21.01, 25.03, 31.89, 0.5649999999999977, -0.43250000000000455, -1.6400000000000006, -2.2875000000000156, -1.845000000000006, 0.9424999999999955, -1.6500000000000483, -2.197499999999991, -3.6825000000000045, -3.437499999999986, -3.2624999999999886, -3.007499999999993, -6.095000000000013, -3.0175000000000125, -4.49499999999999, -4.555000000000007, -5.52500000000002, -3.5075000000000074, -5.135000000000005, -4.399999999999977, -7.535000000000011, -5.030000000000015, -4.922499999999971, -5.252500000000026, -4.547500000000028, -4.549999999999997, -5.0575000000000045, -4.99499999999999, -5.332499999999996, -4.665000000000006, -4.480000000000032, -5.5449999999999875, -4.547499999999985, -4.977499999999992, -5.33250000000001, -5.50250000000004, -4.617499999999993, -5.312500000000028, -5.779999999999973, -5.719999999999999, -5.172499999999985, -5.424999999999969, -4.154999999999987, -5.587499999999963, -6.472499999999982, -5.210000000000008, -5.155000000000001, -5.8725000000000165, -4.447499999999991, -5.5175000000000125, -4.612499999999997, -5.299999999999983, -5.0249999999999915, -4.807500000000019, -5.22999999999999]
q_10 = [79.72, 83.19, 85.16, 87.31, 81.73, 89.63, 90.21000000000001, 63.790000000000006, 86.86000000000001, 91.29, 75.33, 92.47, 81.49, 92.67999999999999, 92.80000000000001, 93.09, 93.36, 87.10000000000001, 93.5, 93.66, 89.22, 93.46000000000001, 78.36, 91.92, 84.22, 93.73, 83.86, 94.69, 83.28, 94.63000000000001, 91.67999999999999, 94.48, 94.54, 94.31, 94.97, 94.8, 94.33000000000001, 94.84, 94.57000000000001, 94.95, 94.78, 71.95, 93.77, 95.23, 69.04, 72.76, 87.49000000000001, 95.02000000000001, 95.22000000000001, 94.34, 95.56, 73.3, 88.03, 89.93, 95.39, 90.05, 95.35000000000001, 60.88]
q_100 = [32.75, 39.2, 46.92, 53.31, 57.76, 63.36000000000001, 65.92, 67.99, 70.63000000000001, 71.77, 73.82000000000001, 76.56, 76.26, 78.60000000000001, 79.75, 80.25, 80.38, 81.06, 82.46000000000001, 82.65, 83.13000000000001, 84.84, 84.87, 85.35000000000001, 84.63, 86.37, 84.25, 86.36000000000001, 86.60000000000001, 86.76, 87.43, 88.02, 87.89, 87.63, 87.89, 88.31, 89.36, 88.93, 89.14, 88.85, 89.35, 89.83, 89.58000000000001, 90.05, 90.17, 90.25, 90.12, 90.46, 90.86, 90.71000000000001, 90.56, 89.97, 90.86, 90.65, 90.73, 91.24000000000001, 91.28, 91.50000000000001]
q_200 = [20.549999999999997, 23.549999999999997, 26.529999999999998, 30.2, 33.11, 37.64, 41.949999999999996, 46.410000000000004, 50.64999999999999, 50.849999999999994, 33.77999999999999, 57.14000000000001, 57.620000000000005, 61.400000000000006, 64.27, 65.76, 66.22, 66.01, 66.12, 70.24000000000001, 72.52, 57.69, 71.85000000000001, 75.38000000000001, 76.58000000000001, 76.19000000000001, 77.95, 75.41, 77.09, 78.86, 79.94, 80.59, 80.66, 81.07000000000001, 81.51, 81.88, 81.56, 82.36, 82.32000000000001, 82.69, 82.8, 82.35000000000001, 83.1, 82.45, 83.76, 83.02, 83.18, 85.12, 85.53, 84.44000000000001, 85.14000000000001, 84.71, 85.05000000000001, 84.5, 84.06, 86.52, 85.17, 87.0]
def graph_combine_histogram():
    x_axis = [10, 40, 100, 200]
    
    fig, ax1 = plt.subplots(dpi = 500)

    # Set position of bar on X axis
    barWidth = 0.12
    br1 = np.arange(len(x_axis))
    br2 = [x + barWidth for x in br1]
    br3 = [x + barWidth for x in br2]
    br4 = [x + barWidth for x in br3]
    br5 = [x + barWidth for x in br4]

    
    q_total_utility = [sum(q_200), sum(q_100), sum(q_utility_40),sum(q_10)]
    shapley_total_utility = [sum(sv_200), sum(sv_100), sum(shapley_utility_40),sum(sv_10)]
    greedy_total_utility = [sum(greedy_200), sum(greedy_100), sum(greedy_40),sum(greedy_10)]
    uniform_total_utility = [0,0, sum(uniform_40), sum(uni_10)]
    # FIFL_total_utility = [sum(fifl_200), sum(fifl_100), sum(fifl_40),sum(fifl_10)]
    
    plt.bar(br1, q_total_utility, color ='r', width = barWidth, edgecolor ='grey', label ='ROBOFL',hatch='///')
    plt.bar(br2, shapley_total_utility, color ='blue', width = barWidth, edgecolor ='grey', label ='SV', hatch="xx")
    plt.bar(br3, greedy_total_utility, color ='black', width = barWidth, edgecolor ='grey', label ='Greedy',hatch='..')
    plt.bar(br4, uniform_total_utility, color ='green', width = barWidth, edgecolor ='grey', label ='Uniform', hatch='/')
    # plt.bar(br5, FIFL_total_utility, color ='orange', width = barWidth, edgecolor ='grey', label ='FIFL',  hatch='.O')
   
    ax1.set_xlabel("Client's sample size", fontsize=15,  fontweight='bold')
    ax1.set_ylabel('Total Utility', fontsize=15, fontweight='bold')
    plt.xticks([r + (barWidth) for r in range(len(x_axis))],
        ['300', '600', '1500', '6000'])
    ax1.set_ylim([-200,6500])
    
    ax1.legend(fontsize= 12)
    # plt.show()
    ax1.grid(axis='y')
    file_name=f"total_util_comparison.pdf"
    plt.savefig(file_name, dpi = 500)

# graph_combine_histogram()

q_cost_40 =[0, 35.42, 34.26, 16.9, 0.9699999999999989, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996, 0.19999999999999996]
shapley_cost_40 = [0, 0, 0, 0, 16.050461538461537, 18.349615384615383, 20.150307692307692, 22.52838461538461, 23.838923076923074, 25.330153846153852, 26.563846153846157, 27.49015384615384, 28.524461538461534, 28.95023076923077, 29.953384615384618, 30.804923076923075, 31.224461538461544, 31.61492307692308, 32.034461538461535, 32.491384615384604, 32.62015384615385, 33.334615384615375, 33.5153076923077, 33.6503076923077, 33.97430769230769, 34.09269230769231, 34.171615384615386, 34.43538461538461, 34.441615384615375, 34.56, 35.28484615384615, 34.958769230769235, 35.23707692307692, 35.137384615384626, 35.737615384615395, 35.74592307692308, 35.424, 35.748000000000005, 35.775, 36.05746153846153, 35.82276923076923, 36.28176923076923, 36.27969230769231, 36.43130769230769, 36.48530769230769, 37.075153846153846, 36.5933076923077, 36.58915384615384, 36.942230769230775, 36.57876923076923, 36.79684615384615, 37.03361538461538, 36.80307692307693, 36.96092307692307, 37.22053846153846, 36.96507692307693, 37.19146153846154, 36.63900000000001, 37.264153846153846, 37.33684615384616]
greedy_cost_40 = [0, 0, 0, 0, 28, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0, 22.40000000000001, 0]
uniform_cost_40 = [0, 0, 0, 0, 23, 34.5, 36.24828810300751, 39.10063076533957, 41.58411800154755, 43.93690503050882, 46.20350337336084, 48.36138034513579, 50.41591790484666, 52.39478377974624, 54.29441354024788, 56.143470164706066, 57.919664427521624, 59.64709048656877, 61.33724439439391, 62.968630739563395, 64.56679084462925, 66.12852941457459, 67.64565661942665, 69.13407956377657, 70.58850727279821, 72.01776418982169, 73.4174166348116, 74.79182501852235, 76.13646915813068, 77.46293358293589, 78.76527523958944, 80.04909709224242, 81.31063287062963, 82.55126130686517, 83.77630045670375, 84.98167583786861, 86.17073343432715, 87.34423887795164, 88.50129100007774, 89.64670282296326, 90.77323193651104, 91.88654578384104, 92.98867200107189, 94.07829978683891, 95.15321700530912, 96.21823434999679, 97.26919653560084, 98.31009980977045, 99.34061555686878, 100.36027932907089, 101.36913893839434, 102.3672209009039, 103.35700911761798, 104.33750715897406, 105.30858320593401, 106.27006090958155, 107.22427102937417, 108.1687611469334, 109.10699911057591, 110.03549234215967]
fifl_cost_40 = [0, 0, 0, 0, 28.553347323442306, 17.618214640226046, 14.92434356833303, 8.781358575461661, 7.396131775080922, 6.319839199577068, 5.230561154039401, 5.2576112035994464, 4.403781802442854, 3.8929750732591755, 4.043017237931683, 3.769848523140526, 3.6830943050117133, 3.5114120245427016, 3.772759137850486, 3.275933364760344, 3.135412807196957, 3.186706071548014, 3.931461384456392, 3.734515677765963, 3.3955346056874203, 3.491154052927591, 3.2872379654296005, 3.383854582618219, 2.9923889911210595, 3.2292295356236522, 3.5216954852517066, 3.328929109427542, 3.3836790286326655, 3.290692229246707, 3.28040878655599, 3.2897213889183456, 3.2274179219470023, 3.5860740124053394, 3.607825385894089, 3.8195288166540347, 3.652329729751807, 3.357415373923897, 3.628973207369915, 3.3351845776954785, 4.189150171650976, 3.4659040287600775, 3.6451013616106938, 3.5582461937995555, 3.366544921871233, 3.469994133706856, 3.6330640079939447, 3.861725799755659, 3.717131421375588, 3.711734061443221, 3.796495499618621, 3.748163159929983, 3.7372750702580455, 3.481681195695293, 3.6240527141878047, 3.7362131348134118]

q_total_utility = print(sum(q_utility_40))
shapley_total_utility = print(sum(shapley_utility_40))
greedy_total_utility = print(sum(greedy_40))
uniform_total_utility = print(sum(uniform_40))
# FIFL_total_utility = print(sum(fifl_40))

q_total_cost = print(sum(q_cost_40))
shapley_total_cost = print(sum(shapley_cost_40))
greedy_total_cost = print(sum(greedy_cost_40))
uniform_total_cost =  print(sum(uniform_cost_40))
FIFL_total_cost = print(sum(fifl_cost_40))

def calculate_JFI(y, z, n=5):
    arr = []
    for idx in range(len(y)):
        if(z[idx]) == 0:
            continue
        arr.append(y[idx] / z[idx])
    
    top =  sum(arr)*sum(arr) 

    arr_2 = []
    for idx in range(len(y)):
        if(z[idx]) == 0:
            continue
        squared = (y[idx] / z[idx]) * (y[idx] / z[idx])
        arr_2.append(squared)
    bottom = sum(arr_2)
    # print(bottom)
    jfi = top/ (len(y) * bottom)
    print(jfi)
    return jfi
    
# calculate_JFI(uniform_40,uniform_cost_40)
emnist = [39.76063829787234, 43.42553191489362, 42.063829787234035, 45.95212765957447, 33.91489361702128, 47.84787234042553, 60.53723404255319, 58.535106382978725, 60.880851063829795, 57.327659574468086, 56.22659574468086, 58.81170212765957, 57.42340425531915, 53.55106382978724, 55.14148936170213, 58.152127659574475, 55.12553191489363, 60.731914893617024, 54.77978723404256, 60.07765957446809, 59.17872340425532, 59.26914893617022, 60.63085106382979, 66.806382978723406, 68.088297872340426, 67.95531914893617, 56.130851063829795, 55.46063829787235, 63.50851063829787, 59.96595744680852, 57.045744680851065, 59.306382978723406, 59.15744680851064, 61.317021276595746, 55.96063829787235, 60.60425531914894, 55.92872340425532, 56.67872340425532, 55.731914893617024, 57.03510638297872, 57.18936170212766, 60.380851063829795, 56.40212765957447, 54.58829787234043, 56.625531914893614, 56.49787234042554, 58.60425531914894, 56.652127659574475, 57.4872340425532, 56.98191489361703, 58.25851063829787, 59.535106382978725, 63.47659574468085, 61.54574468085107, 60.8968085106383, 67.81170212765957, 66.439361702127655, 69.886170212765954]
fmnist_40 = [33.97, 44.4, 58.03999999999999, 69.42, 67.83, 76.27000000000001, 76.21000000000001, 79.12, 79.72, 81.09, 77.63000000000001, 80.98, 81.97, 81.84, 81.38, 81.98, 79.2, 81.12, 81.86, 82.98, 83.09, 83.41, 82.23, 82.58, 79.84, 83.0, 65.33, 82.37509505703422, 83.91, 84.59, 82.84, 70.23, 84.54, 84.56, 83.84, 85.25000000000001, 84.87, 85.14000000000001, 84.42, 84.51, 85.02, 85.28, 83.55000000000001, 84.71, 85.63, 85.77000000000001, 84.95, 85.32, 83.86, 85.85000000000001, 85.12, 85.56, 84.57000000000001, 85.92, 86.14, 85.71, 84.61, 85.69]
u_optimal =[32.92, 57.120000000000005, 69.21, 78.58, 83.23, 86.38, 88.16, 89.57, 90.36999999999999, 91.10000000000001, 91.62, 91.88, 92.4, 92.78, 93.23, 93.43, 93.44, 93.78999999999999, 93.94, 94.06, 94.24000000000001, 94.44, 94.48, 94.69, 94.72, 94.85000000000001, 94.86, 94.98, 95.08, 95.17999999999999, 95.17, 95.37, 95.33, 95.47, 95.47, 95.64, 95.57, 95.71, 95.63000000000001, 95.83, 95.89, 95.82, 95.87, 95.89999999999999, 95.95, 96.0, 96.09, 96.09, 96.08, 96.09, 96.18, 96.2, 96.23, 96.24000000000001, 96.2, 96.23, 96.17, 96.27]
# cifar10_40 = [61.36000000000001, 60.45, 61.809999999999995, 61.09, 57.38, 55.88, 53.55, 43.63522388059702, 56.09584635645302, 50.470000000000006, 50.18000000000001, 48.74, 54.26, 49.870000000000005, 43.440000000000005, 54.77078981225097, 51.74999999999999, 53.75, 49.07, 49.38, 51.45, 46.34, 59.910000000000004, 51.480000000000004, 45.64, 61.3, 49.89000000000001, 49.28000000000001, 53.14, 51.83, 47.96, 45.800000000000004, 57.919999999999995, 50.22, 51.15, 51.059999999999995, 51.32, 52.34, 54.300000000000004, 49.790000000000006, 45.760000000000005, 55.73176339194741, 51.71, 49.64, 54.160000000000004, 55.489999999999995, 53.53, 48.830000000000005, 52.63, 51.46, 51.66, 51.11000000000001, 47.38, 55.35, 49.12, 52.60000000000001, 50.66, 50.25]

GPSS_util = [10.799389780201475, 15.309389780201476, 18.21938978020147, 21.849389780201474, 24.529389780201473, 26.389389780201476, 29.18938978020147, 31.639389780201473, 34.43938978020147, 38.499389780201476, 41.319389780201476, 43.259389780201474, 46.09938978020148, 47.22938978020147, 51.45938978020148, 51.859389780201475, 54.29938978020147, 55.849389780201484, 58.35938978020147, 60.219389780201475, 61.36938978020147, 61.818779560402945, 62.64877956040295, 64.40877956040295, 65.36877956040296, 66.80877956040295, 67.45877956040295, 68.20816934060441, 66.74694890100737, 67.46694890100737, 68.13694890100737, 69.12694890100737, 69.06694890100738, 69.67694890100738, 70.06694890100738, 71.55694890100737, 70.92694890100736, 72.81694890100738, 73.13694890100737, 73.27694890100737, 73.54694890100737, 73.41694890100737, 72.58633868120884, 74.70694890100738, 75.16694890100737, 73.24511824161179, 76.43694890100737, 76.43694890100737, 72.22389780201475, 73.94450802181326, 76.80694890100737, 73.51389780201475, 77.28694890100736, 74.46450802181327, 78.43694890100738, 74.57389780201474, 79.02694890100737, 74.58389780201475, 78.58694890100737, 76.30450802181326, 79.90694890100737, 75.56389780201475, 80.46694890100737, 75.06328758221622, 75.18328758221622, 81.01694890100737, 81.21694890100737, 75.14267736241769, 75.80328758221621, 76.38328758221623, 80.96694890100737, 75.37267736241769, 75.77267736241768, 75.94267736241768, 81.79694890100737, 74.42145692282064, 81.96694890100737, 73.84084670302211, 82.58694890100737, 75.08145692282064]
GPSS_budget = [0, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 0.8519625502966904, 2.5558876508900714, 2.5558876508900714, 4.2598127514834525, 4.2598127514834525, 4.2598127514834525, 4.2598127514834525, 4.2598127514834525, 10.223550603560284, 4.2598127514834525, 11.075513153856974, 4.2598127514834525, 12.779438254450355, 4.2598127514834525, 4.2598127514834525, 16.187288455637116, 15.335325905340426, 4.2598127514834525, 4.2598127514834525, 20.447101207120568, 4.2598127514834525, 4.2598127514834525, 4.2598127514834525, 4.2598127514834525, 22.15102630771395, 22.15102630771395, 4.2598127514834525, 23.00298885801064, 22.15102630771395, 4.2598127514834525, 9.371588053263594, 5.111775301780142, 5.111775301780142, 5.111775301780142, 4.259812751483452, 5.111775301780142, 5.111775301780142, 5.111775301780142, 5.111775301780142, 5.111775301780142, 5.111775301780142, 5.111775301780142, 4.259812751483452, 5.111775301780142, 5.111775301780142, 5.111775301780142, 5.111775301780142, 5.111775301780142, 5.111775301780142, 5.111775301780142, 4.259812751483452, 5.111775301780142, 5.111775301780142, 5.111775301780142]	
RRAFL_util = [14.099999999999998, 11.065826460872291, 15.305826460872293, 18.06582646087229, 20.13582646087229, 21.49582646087229, 24.70582646087229, 26.39582646087229, 29.62582646087229, 31.425826460872287, 34.70582646087229, 36.235826460872296, 39.80582646087229, 41.465826460872286, 44.62582646087229, 46.715826460872286, 48.605826460872294, 50.35582646087229, 52.15582646087229, 53.99582646087229, 54.72582646087229, 56.455826460872295, 57.395826460872286, 58.36582646087229, 59.345826460872296, 60.49582646087229, 61.9058264608723, 63.30582646087229, 63.80582646087229, 64.1358264608723, 65.11582646087228, 66.01582646087229, 66.5358264608723, 67.4058264608723, 67.76582646087229, 67.98582646087229, 68.9458264608723, 69.6958264608723, 70.0658264608723, 70.7858264608723, 70.79582646087229, 71.8558264608723, 72.99582646087228, 72.3458264608723, 72.49582646087228, 73.3558264608723, 73.73582646087229, 74.5358264608723, 74.4058264608723, 74.46582646087231, 74.7258264608723, 75.0358264608723, 75.26582646087229, 75.73582646087229, 76.6358264608723, 76.5358264608723, 76.99582646087231, 77.1358264608723, 77.3858264608723, 77.4758264608723, 76.8458264608723, 77.33582646087228, 77.37582646087228, 77.82582646087229, 77.70582646087229, 78.67582646087229, 78.3558264608723, 78.17582646087229, 78.3458264608723, 78.96582646087228, 78.92582646087229, 79.23582646087229, 79.6958264608723, 79.21582646087231, 79.24582646087228, 80.17582646087229, 80.04582646087229, 80.37582646087228, 79.98582646087229, 80.52582646087228]	
RRAFL_budget = [0, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709, 5.024173539127709]	
Greedy_util = [13.99, 17.299999999999997, 20.4, 13.445510547981343, 10.172482776979788, 5.228730968580447, 4.972332968435982, 6.977018035897739, 9.674244069512884, 12.203994442974054, 13.933980364830752, 17.143980364830746, 19.913980832418662, 23.163983911194194, 24.113980364830752, 27.05398036483075, 28.913980364830742, 30.793980364830745, 32.25398036483075, 34.26398036483074, 35.26398036483074, 36.863980364830745, 37.91398036483075, 38.35398036483075, 40.59398036483074, 42.063980364830755, 42.31398036483074, 43.09398036483074, 44.33398036483074, 45.11398036483075, 45.94398036483075, 47.183980364830745, 47.043980364830745, 48.52398036483075, 48.80398036483075, 48.63398036483075, 48.76398036483074, 49.963980364830746, 50.36398036483075, 51.27398036483075, 52.22398036483075, 51.963980364830746, 52.38398036483075, 52.573980364830746, 53.52398036483075, 53.533980364830754, 53.673980364830754, 53.94398036483075, 54.23398036483076, 55.293980364830745, 55.13398036483075, 55.713980364830746, 55.31398036483074, 56.00398036483075, 56.01398036483074, 56.12398036483074, 56.58398036483075, 56.823980364830746, 57.62398036483074, 57.70398036483074, 57.08398036483075, 58.10398036483075, 57.55398036483075, 58.50398036483075, 58.323980364830746, 58.463980364830746, 58.48398036483076, 59.173980364830754, 58.85398036483075, 59.00398036483075, 59.34398036483074, 59.26398036483074, 59.963980364830746, 59.75398036483074, 59.813980364830755, 60.25398036483074, 60.00398036483075, 60.26398036483074, 60.593980364830756, 60.50398036483075]	
ROBOAFL_util = [14.24, 17.349999999999998, 20.93, 23.810000000000002, 19.369999999999997, 21.950000000000014, 23.22097149603473, 26.44061526703489, 29.485394535055107, 31.389577684462036, 33.65257410479319, 37.19685468409617, 39.21143637075925, 42.22468374013211, 43.9074981951719, 46.512564796530945, 47.573996976537444, 49.81359479368248, 51.64192069228075, 52.58470603392192, 54.08180117225588, 55.04060068029715, 56.234644739665264, 57.98255308925716, 58.28781581677892, 59.94096766082728, 61.48428687329845, 61.834476879109275, 62.38212430815833, 63.97016497340466, 64.94939534155066, 65.28898338573367, 64.65327169656321, 65.68115288781071, 66.81279977907302, 66.46467982288597, 68.18378196528677, 68.22796707046112, 68.94938407412745, 68.59386240211413, 69.63309870016269, 69.94913994456373, 69.92193399052192, 70.62537559115626, 70.83052122203574, 70.92793122202325, 71.42581143920378, 72.09956433846774, 73.02309999382439, 72.47146886540646, 73.17692992904671, 73.60179575859333, 73.83768863841415, 73.35689811112361, 73.31499858300648, 75.7929846617565, 74.4642634288695, 73.72247913256865, 74.23322023106005, 76.19127870681997, 74.95402135953557, 75.47894799120715, 75.24122538472218, 75.63217620841525, 74.84235843773382, 75.5059723733827, 75.32696444652218, 76.25908437421751, 76.23493765702368, 76.13252912247192, 76.29104991559147, 75.31003386498445, 76.40240753972355, 76.93579068110702, 76.94798461095343, 76.3044598081275, 77.05307995675273, 76.40617785177108, 76.79060767080111, 78.14601445924487]	
SV_util = [15.28, 19.57, 24.099999999999998, 25.990000000000002, 30.43, -61.754150660819825, -58.08415066081981, -54.784150660819826, -50.094150660819814, -46.92415066081984, -43.89415066081981, -40.8641506608198, -39.20415066081982, 56.66, -9.562825185642964, -7.452825185643007, -5.072825185642955, 63.51, 9.445429227080957, 10.875429227080957, 66.86, 19.95232889192765, 22.212328891927648, 23.964861347692064, 70.27, 70.08, 26.80764857897865, 71.84, 71.81, 29.138178394448595, 72.32, 29.83563713353329, 73.63, 30.800405541894776, 74.42, 74.25, 31.64634872498118, 74.75, 32.56476823706657, 76.14, 75.28, 33.21315780222405, 76.58, 76.66, 34.51484249541673, 77.28, 34.60498792561482, 78.33, 76.5, 35.935081802455684, 78.10000000000001, 35.525087510565434, 79.36999999999999, 79.16, 36.265090803726984, 36.72509080372698, 79.80000000000001, 37.27509185469444, 80.33, 37.77509213574115, 80.34, 38.405092197147326, 81.62, 38.815092383761424, 82.14, 39.10509239490152, 82.33, 81.78, 39.545092441250475, 82.36, 39.23509244148752, 40.14509244148751, 83.91999999999999, 81.82000000000001, 40.1650924433379, 83.69, 40.3550924439056, 83.46000000000001, 40.9750924439198, 84.39]	
def graph_combine_many_data():
    

    x_axis = [x for x in range(len(GPSS_util))]
    
    fig, ax1 = plt.subplots(dpi = 500)

    ax1.plot(x_axis,GPSS_util, label='GPS-AFL', color='blue', linestyle='solid')
    ax1.plot(x_axis,ROBOAFL_util, label='ROBO-AFL', color='black', linestyle='dashdot')
    ax1.plot(x_axis,RRAFL_util , label='RRAFL', color='green', linestyle='dashed')
    ax1.plot(x_axis,SV_util , label='SV', color='orange', linestyle='dotted')
    ax1.plot(x_axis,Greedy_util , label='Greedy', color='c', linestyle='solid')

    

    ax1.set_xlabel("Time Frame, T", fontsize=15,  fontweight='bold')
    ax1.set_ylabel('Utility', fontsize=15, fontweight='bold')
    
    ax1.legend(fontsize= 12)
    # plt.show()
    plt.grid()
    file_name=f"comparison_dataset.pdf"
    plt.savefig(file_name, dpi = 500)

graph_combine_many_data()


def get_optimal_util(multiplier):

    util_arr = []

    pwd = os.getcwd()
    fp = os.path.join(pwd,'log', 'result.pkl')    
    benchmark = pd.read_pickle("/Users/xavier/Programming/FedLearning/log/Benchmark_MNIST/result.pkl")

    for round in range(60):
        acc = benchmark['accuracy'][round]
        revenue = 100 * acc * multiplier
        cost = 1

        utility = revenue - cost
        util_arr.append(utility)
    return util_arr

# print(get_optimal_util(1))

def graph_combine2(id, budget_arr, L2norm, utility_arr):
    
    while(len(utility_arr) < 60):
        utility_arr.insert(0, 0)
    while(len(L2norm) < 60):
        L2norm.insert(0, 0)
    while(len(budget_arr) < 60):
        budget_arr.insert(0, 0)


    x_axis = [x for x in range(len(budget_arr))]
    
    fig, ax1 = plt.subplots(dpi = 500)

    
    ax1.plot(x_axis,utility_arr, label='Utility', color='blue', linestyle='dashdot')
    ax1.plot(x_axis,L2norm, label='L2Norm-i', color='green', linestyle='dashed')
    ax1.plot(x_axis,budget_arr, label='Budget', color='red' )

    ax1.set_xlabel("Matching round, R", fontsize=15,  fontweight='bold')
    
    
    ax1.legend(fontsize= 15)
    # plt.show()
    plt.grid()
    file_name=f"combined_fed_{id}.pdf"
    plt.savefig(file_name, dpi = 500)




